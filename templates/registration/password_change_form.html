{% extends "base.html" %}
{% load static %}

{% block title %}<title>Parolni o'zgartirish</title>{% endblock title %}

{% block content %}
<section class="form-container2">
    <h1>Parolni o'zgartirish</h1>
    <p class="p-text-pass">Parolni o'zgartirish uchun quyidagi formani to'ldiring!</p>
    <form action="#" method="post">
        {% csrf_token %}
        <div class="form-group">
            <div class="input-group">
                {{ form.old_password.label_tag }}
                <input type="password" name="old_password" class="form-control" id="id_old_password" placeholder="Eski parolni kiriting">
                <div class="input-group-append">
                    <span class="input-group-text" onclick="togglePassword('id_old_password')">
                        <i class="fa fa-eye" id="togglePasswordOld"></i>
                    </span>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="input-group">
                {{ form.new_password1.label_tag }}
                <input type="password" name="new_password1" class="form-control" id="id_new_password1" placeholder="Yangi parolni kiriting">
                <div class="input-group-append">
                    <span class="input-group-text" onclick="togglePassword('id_new_password1')">
                        <i class="fa fa-eye" id="togglePasswordNew2"></i>
                    </span>
                    
                </div>
            </div>
            <small class="form-text text-muted">{{ form.new_password1.help_text|safe }}</small>
        </div>
        <div class="form-group">
            <div class="input-group">
                {{ form.new_password2.label_tag }}
                <input type="password" name="new_password2" class="form-control" id="id_new_password2" placeholder="Yangi parolni tasdiqlang">
                <div class="input-group-append">
                    <span class="input-group-text" onclick="togglePassword('id_new_password2')">
                        <i class="fa fa-eye" id="togglePasswordNew2"></i>
                    </span>
                </div>
            </div>
        </div>
        <p><button type="submit" class="btn-password" onclick="return validatePassword()">Parolni almashtirish</button></p>
    </form>
</section>

<script>
    function togglePassword(inputId) {
        var input = document.getElementById(inputId);
        var icon = input.nextElementSibling.querySelector('i');
        if (input.type === "password") {
            input.type = "text";
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            input.type = "password";
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }

    function validatePassword() {
        var oldPassword = document.getElementById("id_old_password").value;
        var newPassword1 = document.getElementById("id_new_password1").value;
        var newPassword2 = document.getElementById("id_new_password2").value;
        
        if (!oldPassword || !newPassword1 || !newPassword2) {
            alert("Iltimos, hamma maydonlarni to'ldiring.");
            return false;
        }

        if (newPassword1 !== newPassword2) {
            alert("Yangi parollar mos kelmadi. Iltimos, tekshirib qaytadan kiriting.");
            return false;
        }
        
        return true;
    }
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<style>
    .input-group-text {
        cursor: pointer;
    }
</style>

{% endblock content %}
